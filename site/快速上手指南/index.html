
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../%E8%B5%9B%E4%BA%8B%E8%B5%84%E6%BA%90/">
      
      
        <link rel="next" href="../%E8%AF%84%E5%88%86%E7%BB%86%E5%88%99/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>快速上手指南 - Maritime Intelligent Navigation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Maritime Intelligent Navigation" class="md-header__button md-logo" aria-label="Maritime Intelligent Navigation" data-md-component="logo">
      
  <img src="../imagsea/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Maritime Intelligent Navigation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              快速上手指南
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Maritime Intelligent Navigation" class="md-nav__button md-logo" aria-label="Maritime Intelligent Navigation" data-md-component="logo">
      
  <img src="../imagsea/logo.png" alt="logo">

    </a>
    Maritime Intelligent Navigation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%B5%9B%E4%BA%8B%E7%AE%80%E4%BB%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    赛事简介
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%B5%9B%E4%BA%8B%E8%B5%84%E6%BA%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    赛事资源
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    快速上手指南
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    快速上手指南
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-unity3d" class="md-nav__link">
    <span class="md-ellipsis">
      1. Unity3D环境搭建
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Unity3D环境搭建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-unityhub" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 下载UnityHub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-unity" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 下载Unity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 加载工程
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-anaconda" class="md-nav__link">
    <span class="md-ellipsis">
      2. Anaconda环境搭建
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Anaconda环境搭建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-anaconda" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 下载并安装Anaconda
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 创建虚拟环境
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 安装Pytorch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-ml-agents" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 安装ML-Agents包
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-stable-baselines3" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 安装stable-baselines3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    <span class="md-ellipsis">
      2.6 调整其余包版本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27" class="md-nav__link">
    <span class="md-ellipsis">
      2.7 参考环境配置
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 开始运行
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 开始运行">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 手动控制
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 强化学习训练
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-tenserboard" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 使用tenserboard查看训练效果
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 加载训练模型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 切换场景
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4. 工程详解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 工程详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 基础知识
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-unity" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Unity场景
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Unity场景">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.1 区域赛训练场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.2 无人艇(智能体)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#423" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.3 区域赛训练脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#424" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.4 区域赛测试场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#425" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.5 区域赛测试脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#426" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.6 区域赛任务描述
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#426_1" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.6 国赛训练场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#427" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.7 国赛测试场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#428" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.8 国赛测试脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#429" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.9 国赛任务描述
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-python" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Python脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-tips" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 训练tips
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%AF%84%E5%88%86%E7%BB%86%E5%88%99/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    评分细则
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-unity3d" class="md-nav__link">
    <span class="md-ellipsis">
      1. Unity3D环境搭建
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Unity3D环境搭建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-unityhub" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 下载UnityHub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-unity" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 下载Unity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 加载工程
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-anaconda" class="md-nav__link">
    <span class="md-ellipsis">
      2. Anaconda环境搭建
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Anaconda环境搭建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-anaconda" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 下载并安装Anaconda
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 创建虚拟环境
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 安装Pytorch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-ml-agents" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 安装ML-Agents包
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-stable-baselines3" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 安装stable-baselines3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    <span class="md-ellipsis">
      2.6 调整其余包版本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27" class="md-nav__link">
    <span class="md-ellipsis">
      2.7 参考环境配置
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 开始运行
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 开始运行">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 手动控制
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 强化学习训练
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-tenserboard" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 使用tenserboard查看训练效果
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 加载训练模型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 切换场景
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4. 工程详解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 工程详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 基础知识
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-unity" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Unity场景
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Unity场景">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.1 区域赛训练场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.2 无人艇(智能体)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#423" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.3 区域赛训练脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#424" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.4 区域赛测试场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#425" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.5 区域赛测试脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#426" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.6 区域赛任务描述
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#426_1" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.6 国赛训练场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#427" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.7 国赛测试场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#428" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.8 国赛测试脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#429" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.9 国赛任务描述
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-python" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Python脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-tips" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 训练tips
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="_1">平台使用文档</h1>
<h2 id="1-unity3d">1. Unity3D环境搭建</h2>
<h3 id="11-unityhub">1.1 下载UnityHub</h3>
<ul>
<li>官网链接：https://unity.cn/releases</li>
</ul>
<p><img alt="" src="../image2024/unity1.PNG" /></p>
<ul>
<li>注册账号并登录</li>
</ul>
<p><img alt="" src="../image2024/unity2.PNG" /></p>
<ul>
<li>申请个人许可证（许可证到期后可免费延期）</li>
</ul>
<p><img alt="" src="../image2024/unity3.PNG" /></p>
<h3 id="12-unity">1.2 下载Unity</h3>
<ul>
<li>从官网中找到版本为2020.3.10f1c1的Unity，选择从Hub下载</li>
</ul>
<h3 id="13">1.3 加载工程</h3>
<h2 id="2-anaconda">2. Anaconda环境搭建</h2>
<h3 id="21-anaconda">2.1 下载并安装Anaconda</h3>
<h3 id="22">2.2 创建虚拟环境</h3>
<ul>
<li>打开命令行窗口</li>
</ul>
<p><img alt="" src="../image2024/unity4.PNG" /></p>
<ul>
<li>新建虚拟环境，命令为</li>
</ul>
<pre><code>conda create -n match python=3.8
</code></pre>
<ul>
<li>
<p>输入上述命令后按回车键，出现如下画面</p>
</li>
<li>
<p>按y键进行安装</p>
</li>
<li>安装完成后，可通过<code>conda env list</code>命令查看已有的环境</li>
<li>通过<code>conda activate 环境名</code>激活创建的环境</li>
</ul>
<pre><code>conda activate match
</code></pre>
<ul>
<li>通过<code>pip list</code>命令可查看当前环境已安装package</li>
</ul>
<h3 id="23-pytorch">2.3 安装Pytorch</h3>
<ul>
<li>
<p>官网链接：https://pytorch.org/</p>
</li>
<li>
<p>如果电脑没有GPU，则安装CPU版本的Pytorch</p>
</li>
<li>如果电脑有GPU，可通过<code>nvidia-smi</code>命令查看支持的cuda版本，安装对应的Pytorch</li>
</ul>
<pre><code>pip install torch==2.0.1 torchvision==0.15.2 torchaudio==2.0.2 --index-url https://download.pytorch.org/whl/cu118
</code></pre>
<h3 id="24-ml-agents">2.4 安装ML-Agents包</h3>
<pre><code>pip install mlagents==0.30.0
</code></pre>
<h3 id="25-stable-baselines3">2.5 安装stable-baselines3</h3>
<pre><code>pip install stable-baselines3==2.1.0
</code></pre>
<h3 id="26">2.6 调整其余包版本</h3>
<p>若运行python脚本时提示某个package版本过高或过低，可手动安装符合要求的版本</p>
<pre><code>pip install 包名==包版本
</code></pre>
<h3 id="27">2.7 参考环境配置</h3>
<pre><code>Package                    Version
-------------------------- ------------
absl-py                 2.1.0
attrs                   23.2.0
cachetools              5.3.3
cattrs                  1.5.0
certifi                 2022.12.7
charset-normalizer      2.1.1
cloudpickle             3.0.0
contourpy               1.1.1
cycler                  0.12.1
Farama-Notifications    0.0.4
filelock                3.9.0
fonttools               4.51.0
google-auth             2.29.0
google-auth-oauthlib    1.0.0
grpcio                  1.62.1
gym                     0.26.2
gym-notices             0.0.8
gymnasium               0.29.1
h5py                    3.11.0
idna                    3.4
importlib_metadata      7.1.0
importlib_resources     6.4.0
Jinja2                  3.1.2
kiwisolver              1.4.5
Markdown                3.6
MarkupSafe              2.1.3
matplotlib              3.7.5
mlagents                0.30.0
mlagents-envs           0.30.0
mpmath                  1.3.0
networkx                3.0
numpy                   1.21.2
oauthlib                3.2.2
packaging               24.0
pandas                  2.0.3
PettingZoo              1.15.0
pillow                  10.2.0
pip                     23.3.1
protobuf                3.20.2
pyasn1                  0.6.0
pyasn1_modules          0.4.0
pyparsing               3.1.2
pypiwin32               223
python-dateutil         2.9.0.post0
pytz                    2024.1
pywin32                 306
PyYAML                  6.0.1
requests                2.28.1
requests-oauthlib       2.0.0
rsa                     4.9
setuptools              68.2.2
Shimmy                  1.1.0
six                     1.16.0
stable-baselines3       2.1.0
sympy                   1.12
tensorboard             2.14.0
tensorboard-data-server 0.7.2
torch                   2.0.1+cu118
torchaudio              2.0.2+cu118
torchvision             0.15.2+cu118
typing_extensions       4.8.0
tzdata                  2024.1
urllib3                 1.26.13
Werkzeug                3.0.2
wheel                   0.41.2
zipp                    3.18.1
</code></pre>
<h2 id="3">3. 开始运行</h2>
<ul>
<li>确保已成功配置Unity工程和python虚拟环境</li>
</ul>
<h3 id="31">3.1 手动控制</h3>
<ul>
<li>单击编辑器上方的运行按钮</li>
<li>使用键盘控制无人艇运动</li>
<li>W 前进</li>
<li>A 左转</li>
<li>D 右转</li>
</ul>
<h3 id="32">3.2 强化学习训练</h3>
<ul>
<li>使用Pycharm或VScode等编辑器创建python脚本</li>
<li>粘贴下列代码</li>
</ul>
<pre><code class="language-python">from mlagents_envs.environment import UnityEnvironment as UE
from mlagents_envs.envs.unity_gym_env import UnityToGymWrapper
from stable_baselines3 import PPO

UniytEnv = UE()
env = UnityToGymWrapper(UniytEnv,flatten_branched=True, allow_multiple_obs=False)

model = PPO(
    'MlpPolicy',
    env=env,
    batch_size=64,
    gamma=0.999,
    gae_lambda=0.98,
    verbose=1,
    device=&quot;cuda&quot;,
    tensorboard_log=&quot;./tb_logs/usv/&quot;,
)

model.learn(
    total_timesteps=500000,
)

model.save(&quot;ppo_navigation_policy&quot;)

</code></pre>
<ul>
<li>选择第2节创建的虚拟环境运行脚本</li>
<li>单击unity编辑器的运行按钮，开始训练</li>
</ul>
<h3 id="33-tenserboard">3.3 使用tenserboard查看训练效果</h3>
<ul>
<li>打开命令行窗口，激活第2节创建的虚拟环境</li>
<li>进入训练日志的生成目录，如“./tb_logs/usv/”</li>
<li>输入下列命令</li>
</ul>
<pre><code>tensorboard --logdir 文件夹名(如PPO_1)
</code></pre>
<ul>
<li>浏览器打开网址，默认为http://localhost:6006/</li>
</ul>
<p><img alt="" src="../image2024/unity24.PNG" /></p>
<h3 id="34">3.4 加载训练模型</h3>
<ul>
<li>使用Pycharm或VScode等编辑器创建python脚本</li>
<li>粘贴下列代码</li>
</ul>
<pre><code class="language-python">from mlagents_envs.environment import UnityEnvironment as UE
from mlagents_envs.envs.unity_gym_env import UnityToGymWrapper
from stable_baselines3 import PPO

episode = 0
rew_total = 0
rew_per_ep = 0
step = 0


def show_ep():
    print(&quot;Episode: &quot;, episode)
    print(&quot;Step: &quot;, step)
    print(&quot;Reward: &quot;, round(rew_per_ep, 4))
    print(&quot;Average of Reward: &quot;,  round(rew_total / episode, 4))


UnityEnv = UE()
env = UnityToGymWrapper(UnityEnv,flatten_branched=True, allow_multiple_obs=False)
model = PPO.load(&quot;ppo_navigation_policy&quot;, env=env)
obs = env.reset()
while True:
    action, _states = model.predict(obs)
    obs, rewards, dones, info = env.step(action)
    step += 1
    rew_total += rewards
    rew_per_ep += rewards
    if dones:
        episode += 1
        show_ep()
        step = 0
        rew_per_ep = 0
        obs = env.reset()

</code></pre>
<ul>
<li>选择第2节创建的虚拟环境运行脚本</li>
<li>单击unity编辑器的运行按钮，查看训练效果</li>
</ul>
<h3 id="35">3.5 切换场景</h3>
<p><strong>注意：训练场景同一时刻只能开启一个，否则无法打包训练环境</strong></p>
<p>以区域赛训练场景切换至国赛训练场景为例：</p>
<ul>
<li>选中Hierarchy中的regional_train_scenario，将Inspector窗口中的对勾取消</li>
</ul>
<p><img alt="" src="../image2024/unity23.PNG" /></p>
<ul>
<li>选中Hierarchy中的national_train_scenario，将Inspector窗口中的对勾勾选</li>
</ul>
<h2 id="4">4. 工程详解</h2>
<h3 id="41">4.1 基础知识</h3>
<ul>
<li><strong>强化学习</strong></li>
</ul>
<p>​&emsp;&emsp;强化学习是机器学习的一个重要分支。它研究的问题是智能体在未知的环境中，如何优化自身的决策、采取最优行为来极大化奖励的期望值。</p>
<p><img alt="" src="../image2024/unity10.png" /></p>
<p>​&emsp;&emsp;强化学习将世界分为两部分，智能体(Agent)和环境(Environment)。智能体从环境中感知到当前时刻的状态<span class="arithmatex"><span class="MathJax_Preview">S_t</span><script type="math/tex">S_t</script></span>和奖励<span class="arithmatex"><span class="MathJax_Preview">R_t</span><script type="math/tex">R_t</script></span>，之后根据感知信息进行决策并采取动作<span class="arithmatex"><span class="MathJax_Preview">A_t</span><script type="math/tex">A_t</script></span>，动作被执行后影响环境进入下一个状态。智能体继续获得下一时刻的状态<span class="arithmatex"><span class="MathJax_Preview">S_{t+1}</span><script type="math/tex">S_{t+1}</script></span>和奖励<span class="arithmatex"><span class="MathJax_Preview">R_{t+1}</span><script type="math/tex">R_{t+1}</script></span>。智能体的目的是获得的奖励尽可能多。</p>
<ul>
<li><strong>马尔可夫决策过程(MDP)</strong></li>
</ul>
<p>​&emsp;&emsp;马尔可夫决策过程可以用五元组表示 <span class="arithmatex"><span class="MathJax_Preview">&lt;S,A,P,R,\gamma&gt;</span><script type="math/tex"><S,A,P,R,\gamma></script></span> ，其中，<span class="arithmatex"><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span>为状态集合，<span class="arithmatex"><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span>为动作集合，<span class="arithmatex"><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span>为状态转移概率，<span class="arithmatex"><span class="MathJax_Preview">R</span><script type="math/tex">R</script></span>为奖励函数，<span class="arithmatex"><span class="MathJax_Preview">\gamma</span><script type="math/tex">\gamma</script></span>为折扣因子。</p>
<ul>
<li><strong>ML-Agents</strong></li>
</ul>
<p>​&emsp;&emsp;ML-Agents是Unity提供的用于强化学习训练的功能包。借助该功能包，可以将自定义的Unity环境建模为马尔可夫决策过程，然后使用Gym Wrapper转化为强化学习训练环境，进而通过与Python的通信实现神经网络的训练。详细介绍可查看官方文档：https://github.com/Unity-Technologies/ml-agents</p>
<p><strong>本工程基于ML-Agents框架，搭建了Unity水域场景，定义了马尔可夫决策过程，并将场景包装为Gym式训练环境</strong></p>
<p><img alt="" src="../image2024/unity12.PNG" /></p>
<h3 id="42-unity">4.2 Unity场景</h3>
<h4 id="421">4.2.1 区域赛训练场景</h4>
<p>​&emsp;&emsp;如下图所示，区域赛训练场景为10m*10m大小的方形区域，对应Hierarchy窗口中“regional_train_scenario”</p>
<p><img alt="" src="../image2024/unity17.PNG" /></p>
<p><img alt="" src="../image2024/unity18.PNG" /></p>
<p><img alt="" src="../image2024/unity19.PNG" /></p>
<p>​&emsp;&emsp;场景包含：</p>
<ul>
<li>无人艇(USV100)</li>
<li>四周的墙体(Walls)</li>
</ul>
<p><img alt="" src="../image2024/unity7.PNG" /></p>
<ul>
<li>障碍物(Obstacles)</li>
</ul>
<p><img alt="" src="../image2024/unity8.PNG" /></p>
<p><img alt="" src="../image2024/unity9.PNG" /></p>
<ul>
<li>目标点(Target)</li>
</ul>
<p><img alt="" src="../image2024/unity26.PNG" /></p>
<ul>
<li>相机(Camera)</li>
</ul>
<h4 id="422">4.2.2 无人艇(智能体)</h4>
<p>​&emsp;&emsp;无人艇上搭载了强化学习训练必要的脚本控件和激光雷达传感器</p>
<ul>
<li>Behavior Parameters</li>
<li><code>Behavior Name</code>：行为名称</li>
<li><code>Vector Observation-&gt;Space Size</code>：向量观测大小，与训练脚本中状态空间设置有关(见4.2.3 收集观测函数，1+1+18=20)；二者不一致，编译器会给出警告</li>
<li><code>Actions-&gt;Continuous Actions</code>：连续动作空间数量；本工程使用离散动作空间，因此为0</li>
<li><code>Actions-&gt;Discrete Branch</code>：1个离散动作空间，大小为4，对应4.2.3 控制函数</li>
</ul>
<p><img alt="" src="../image2024/unity13.PNG" /></p>
<ul>
<li>Regional_Train：训练脚本</li>
<li><code>Max Step</code>：回合最大步数</li>
<li><code>Target</code>：目标点</li>
</ul>
<p><img alt="" src="../image/unity14.PNG" /></p>
<ul>
<li>Decision Requester</li>
<li><code>Decision Period</code>：智能体探索多少步后接收一次决策</li>
</ul>
<p><img alt="" src="../image2024/unity15.PNG" /></p>
<ul>
<li>激光雷达：USV100搭载了一个单线激光雷达，测距范围为0-15m，水平视场角为360°，角分辨率为1°，可用于感知周围环境。具体使用方法见 4.2.3 收集观测函数</li>
</ul>
<h4 id="423">4.2.3 区域赛训练脚本</h4>
<p>​&emsp;&emsp;基于ML-Agents提供的Agent基类实现，对应Project窗口中Assets/Scripts/Regional_Train，已挂载到场景中的智能体(USV100)上</p>
<p>下面给出详细解释</p>
<ul>
<li>初始化函数：训练开始时执行，用于初始化操作</li>
</ul>
<pre><code class="language-c#">public override void Initialize()
{
    rBody = GetComponent&lt;Rigidbody&gt;(); //获取刚体控件
    Lidar = GetComponentInChildren&lt;VelodyneSensor&gt;();   //获取激光雷达控件
}
</code></pre>
<ul>
<li>回合起始函数：每个回合开启时执行，用于回合的初始化</li>
</ul>
<pre><code class="language-c#">public override void OnEpisodeBegin()
{
    rBody.velocity = Vector3.zero;  //无人艇速度置0
    transform.localPosition = new Vector3(GetRandomPos().x, 0.5f, GetRandomPos().z); //随机设置无人艇位置
    Target.transform.localPosition = GetRandomPos(); //随机设置目标点位置
    transform.localRotation = Quaternion.Euler(new Vector3(0.0f, 0.0f, 0.0f)); //设置无人艇朝向
}
</code></pre>
<ul>
<li>收集观测函数：以向量观测的形式，定义状态空间；状态空间大小对应<code>Behavior Parameters-&gt;Vector Observation-&gt;Space Size</code></li>
</ul>
<pre><code class="language-c#">public override void CollectObservations(VectorSensor sensor)
{
    var localVelocity = transform.InverseTransformDirection(rBody.velocity); //获取无人艇速度

    sensor.AddObservation(localVelocity.magnitude);  //将无人艇速度大小加入状态空间，1维向量
    sensor.AddObservation(Vector3.Distance(Target.transform.localPosition, transform.localPosition));   //观测距目标点的距离，1维向量

    Lidar.CompleteJob();    //激光雷达完成检测

    float[] lidar_param = Enumerable.Range(0, Lidar.distances.Length / 20)
                              .Select(i =&gt; Lidar.distances.Skip(i * 20).Take(20).Min())
                              .ToArray();   //将激光雷达各个射线的检测值分为20组，每组取一个最小值，加入lidar_param数组中
    for (int i = 0; i &lt; lidar_param.Length; i++)
    {
        sensor.AddObservation(lidar_param[i]);  //观测lidar_param，18维向量
    }
}
</code></pre>
<ul>
<li>动作反馈函数：执行动作，同时可设置奖励函数</li>
</ul>
<pre><code class="language-c#">public override void OnActionReceived(ActionBuffers actionBuffers)
{
    MoveAgent(actionBuffers.DiscreteActions); //执行动作
    AddReward(-1 * MaxRew / MaxStep);   //时间惩罚
    if (Vector3.Distance(Target.transform.localPosition, transform.localPosition) &lt; 1.0f)
    {
        AddReward(MaxRew);
        EndEpisode();
    }   //当距离目标点的距离小于1的时候，认为到达目标点，给予正奖励并结束当前回合
}
</code></pre>
<ul>
<li>控制函数：定义无人艇的运动方式，此部分无需改动</li>
</ul>
<pre><code class="language-c#">public void MoveAgent(ActionSegment&lt;int&gt; act)
{
    var dirToGo = Vector3.zero;
    var rotateDir = Vector3.zero;

    var action = act[0];
    switch (action)     //离散动作空间，共四个动作：0为静止，1为前进，2为右转，3为左转
    {
        case 1:
            dirToGo = transform.forward * 1f;
            break;
        case 2:
            rotateDir = transform.up * 1f;
            break;
        case 3:
            rotateDir = transform.up * -1f;
            break;
    }
    transform.Rotate(rotateDir, Time.deltaTime * 30f);  //转向
    rBody.AddForce(dirToGo * force, ForceMode.VelocityChange);  //前进

    if (rBody.velocity.sqrMagnitude &gt; 1.0f) //限制最大速度为1.0
    {
        rBody.velocity = rBody.velocity.normalized;
    }
}
</code></pre>
<ul>
<li>启发函数：用于键盘控制，手动检测动作空间是否符合预期，无需改动</li>
</ul>
<pre><code class="language-c#">public override void Heuristic(in ActionBuffers actionsOut)
{
    var discreteActionsOut = actionsOut.DiscreteActions;
    discreteActionsOut[0] = 0;
    if (Input.GetKey(KeyCode.D))
    {
        discreteActionsOut[0] = 2;
    }
    else if (Input.GetKey(KeyCode.W))
    {
        discreteActionsOut[0] = 1;
    }
    else if (Input.GetKey(KeyCode.A))
    {
        discreteActionsOut[0] = 3;
    }
}
</code></pre>
<ul>
<li>碰撞检测函数：检测是否与障碍物发生碰撞，若碰撞则给予负奖励并结束本回合，无需改动</li>
</ul>
<pre><code class="language-c#">void OnTriggerEnter(Collider other)
{
    if (other.gameObject.CompareTag(&quot;Obstacles&quot;))
    {
        AddReward(-1 * MaxRew);
        EndEpisode();
    }
    if (other.gameObject.CompareTag(&quot;Walls&quot;))
    {
        AddReward(-1 * MaxRew);
        EndEpisode();
    }
}
</code></pre>
<ul>
<li>随机位置生成函数：用于随机无人艇和目标点的位置，无需改动</li>
</ul>
<pre><code class="language-c#">public Vector3 GetRandomPos()
{
    float x = Random.Range(-4.0f, 4.0f);
    float z = Random.Range(-4.0f, 4.0f);
    Vector3 randomSpawnPos = new Vector3(x, 0.05f, z);
    bool goal_ok = false;
    while (goal_ok == false)    
    {
        x = Random.Range(-4.0f, 4.0f);  //随机生成x坐标
        z = Random.Range(-4.0f, 4.0f);  //随机生成z坐标
        randomSpawnPos = new Vector3(x, 0.05f, z);
        goal_ok = Check_Pos(randomSpawnPos.x, randomSpawnPos.z);    //检测是否与障碍物位置重叠，若重叠则重新生成
    }
    return randomSpawnPos;
}
</code></pre>
<ul>
<li>检测位置函数：检测新生成的位置是否与障碍物重叠，无需改动</li>
</ul>
<pre><code class="language-c#">public bool Check_Pos(float x, float z)
{
    bool goal_ok = true;
    if (x &gt; 1 &amp;&amp; x &lt; 3 &amp;&amp; z &lt; 2.7 &amp;&amp; z &gt; -0.2)
    {
        goal_ok = false;
    }
    else if (x &gt; -4.2 &amp;&amp; x &lt; -1.7 &amp;&amp; z &lt; -0.7 &amp;&amp; z &gt; -3.7)
    {
        goal_ok = false;
    }
    return goal_ok;
}
</code></pre>
<h4 id="424">4.2.4 区域赛测试场景</h4>
<p>​&emsp;&emsp;对应Hierarchy窗口中“regional_test_scenario”，与区域赛训练场景一致</p>
<p><img alt="" src="../image2024/unity5.PNG" /></p>
<p>​&emsp;&emsp;无人艇行进过程中会绘制黄色条带状路径，回合更新后重新绘制，同时在unity端输出上一回合路径的长度。</p>
<p><img alt="" src="../image2024/unity37.PNG" /></p>
<p><img alt="" src="../image2024/unity29.PNG" /></p>
<h4 id="425">4.2.5 区域赛测试脚本</h4>
<ul>
<li>与区域赛训练脚本基本一致，增加了路径显示功能</li>
<li>无需修改</li>
</ul>
<h4 id="426">4.2.6 区域赛任务描述</h4>
<p>​&emsp;&emsp;在区域赛训练场景中，训练无人艇从随机位置出发，躲避障碍物到达随机目标点</p>
<p>​&emsp;&emsp;使用训练好的模型在区域赛测试场景中进行测试，统计20回合内的平均奖励值(由Python测试脚本输出)，奖励值越高，分数越高。奖励值包含3部分：(1)到达目标点获得100；(2)发生碰撞获得-100；(3)时间惩罚，每步获得-0.1</p>
<p>Python脚本输出</p>
<ul>
<li>回合数</li>
<li>该回合步数</li>
<li>该回合奖励值</li>
<li>所有回合平均奖励值</li>
</ul>
<p><img alt="" src="../image2024/unity28.PNG" /></p>
<h4 id="426_1">4.2.6 国赛训练场景</h4>
<p>​&emsp;&emsp;如下图所示，国赛训练场景为20m*20m大小的方形区域，对应Hierarchy窗口中“national_train_scenario”</p>
<p><img alt="" src="../image2024/unity21.PNG" /></p>
<p><img alt="" src="../image2024/unity16.PNG" /></p>
<p>​&emsp;&emsp;相比区域赛训练场景，范围更大，障碍物更多，其余部分与区域赛框架一致。</p>
<p>​&emsp;&emsp;新增障碍物类型</p>
<p><img alt="" src="../image2024/unity27.PNG" /></p>
<h4 id="427">4.2.7 国赛测试场景</h4>
<p>​&emsp;&emsp;如下图所示，国赛测试场景为20m*20m大小的方形区域，对应Hierarchy窗口中“national_test_scenario”</p>
<p><img alt="" src="../image2024/unity22.PNG" /></p>
<p><img alt="" src="../image2024/unity20.PNG" /></p>
<p>​&emsp;&emsp;场景中有15个航路点和10个障碍物，障碍物的种类与国赛训练场景一致。</p>
<p>​&emsp;&emsp;无人艇从固定起点出发，初始目标为第一航路点，每到达一个航路点，该航路点从红色变为绿色，同时目标点切换为下一航路点，直至到达最后一个航路点。</p>
<p>​&emsp;&emsp;无人艇行进过程中会绘制黄色条带状路径，回合更新后重新绘制，同时在unity端输出上一回合路径的长度。</p>
<p><img alt="" src="../image2024/unity38.PNG" /></p>
<p><img alt="" src="../image2024/unity29.PNG" /></p>
<h4 id="428">4.2.8 国赛测试脚本</h4>
<ul>
<li>测试脚本无需修改</li>
<li>动作反馈函数</li>
</ul>
<pre><code class="language-c#">public override void OnActionReceived(ActionBuffers actionBuffers)
{
    MoveAgent(actionBuffers.DiscreteActions);
    AddReward(-1 * MaxRew / MaxStep);
    if (Vector3.Distance(Target.transform.localPosition, transform.localPosition) &lt; arrival_distance &amp;&amp; index != (Waypoints.Length -1)) //无人艇与目标点距离达到临界值时判定为到达，修改航路点颜色，目标点更新为下一航路点
    {
        Waypoints[index++].GetComponent&lt;Renderer&gt;().material.color = new Color(0, 1.0f, 0);
        AddReward(MaxRew);
        Target.transform.localPosition = Waypoints[index].transform.localPosition;
    }

    if (Vector3.Distance(Target.transform.localPosition, transform.localPosition) &lt; arrival_distance &amp;&amp; index == (Waypoints.Length - 1))    //到达最后一个航路点时，回合结束
    {
        AddReward(MaxRew);
        EndEpisode();
    }
}

</code></pre>
<h4 id="429">4.2.9 国赛任务描述</h4>
<p>​&emsp;&emsp;在国赛训练场景中，训练无人艇从随机位置出发，躲避障碍物到达随机目标点</p>
<p>​&emsp;&emsp;使用训练好的模型国赛测试场景中进行测试，统计5回合内的平均奖励值(由Python测试脚本输出)，奖励值越高，分数越高。奖励值包含3部分：(1)每到达一个目标点获得100；(2)发生碰撞获得-100，同时该回合结束；(3)时间惩罚，每步获得-0.00667</p>
<p>Python脚本输出</p>
<ul>
<li>回合数</li>
<li>该回合步数</li>
<li>该回合奖励值</li>
<li>所有回合平均奖励值</li>
</ul>
<p><img alt="" src="../image2024/unity28.PNG" /></p>
<h3 id="43-python">4.3 Python脚本</h3>
<p>​&emsp;&emsp;Python脚本用于将Unity场景打包为Gym训练环境，并搭建用于训练的神经网络</p>
<p>​&emsp;&emsp;参考脚本中使用了stable_baselines3库中的PPO算法网络(该方法适用于不太熟悉强化学习算法的选手)，详细介绍可查看官方文档：<a href="https://stable-baselines3.readthedocs.io/en/master/">Stable-Baselines3</a></p>
<p>​&emsp;&emsp;选手也可以使用自定义的网络，结合Gym环境提供的API完成训练</p>
<ul>
<li>训练脚本，用于区域赛训练场景和国赛训练场景</li>
</ul>
<pre><code class="language-python">from mlagents_envs.environment import UnityEnvironment as UE
from mlagents_envs.envs.unity_gym_env import UnityToGymWrapper
from stable_baselines3 import PPO

UnityEnv = UE()
env = UnityToGymWrapper(UnityEnv,flatten_branched=True, allow_multiple_obs=False) #打包Unity环境

model = PPO(
    'MlpPolicy',
    env=env,
    batch_size=64,
    gamma=0.999,
    gae_lambda=0.98,
    verbose=1,
    device=&quot;cuda&quot;,
    tensorboard_log=&quot;./tb_logs/usv/&quot;,
)   #使用stable_baselines3提供的PPO网络

model.learn(
    total_timesteps=500000,
)   #训练

model.save(&quot;ppo_navigation_policy&quot;)     #保存模型

</code></pre>
<ul>
<li>测试脚本，用于所有场景</li>
</ul>
<pre><code class="language-python">from mlagents_envs.environment import UnityEnvironment as UE
from mlagents_envs.envs.unity_gym_env import UnityToGymWrapper
from stable_baselines3 import PPO

episode = 0
rew_total = 0
rew_per_ep = 0
step = 0


def show_ep():      #打印信息   
    print(&quot;Episode: &quot;, episode)     #回合数
    print(&quot;Step: &quot;, step)           #步数
    print(&quot;Reward: &quot;, round(rew_per_ep, 4))     #该回合奖励
    print(&quot;Average of Reward: &quot;,  round(rew_total / episode, 4))    #平均奖励


UnityEnv = UE()
env = UnityToGymWrapper(UnityEnv,flatten_branched=True, allow_multiple_obs=False)
model = PPO.load(&quot;ppo_navigation_policy&quot;, env=env) #加载训练模型
obs = env.reset()   #场景初始化
while True:
    action, _states = model.predict(obs)
    obs, rewards, dones, info = env.step(action)
    step += 1
    rew_total += rewards
    rew_per_ep += rewards
    if dones:
        episode += 1
        show_ep()
        step = 0
        rew_per_ep = 0
        obs = env.reset()

</code></pre>
<h3 id="44-tips">4.4 训练tips</h3>
<ul>
<li>
<p>根据任务设计状态空间和奖励函数，修改Unity中训练脚本里的收集观测函数和动作反馈函数</p>
</li>
<li>
<p>选择合适的强化学习算法，设计网络结构，优化算法参数，修改Python训练脚本中的model</p>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>